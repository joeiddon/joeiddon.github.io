$(function(){$('.facebook-share-count').each(function(){var $this=$(this);var url=$this.data('url');if(url!=''){$.ajax({url:'https://graph.facebook.com/?id='+encodeURI(url),success:function(response){if(response.share&&response.share.share_count){$this.html(response.share.share_count);}}});}});$('.pinterest-share-count').each(function(){var $this=$(this);var url=$this.data('url');if(url!=''){$.ajax({url:'https://api.pinterest.com/v1/urls/count.json?callback=receivePinterestShareCount&url='+encodeURI(url),dataType:'jsonp'});}});$('.linkedin-share-count').each(function(){var $this=$(this);var url=$this.data('url');if(url!=''){$.ajax({url:'https://www.linkedin.com/countserv/count/share?url='+encodeURI(url),dataType:'jsonp',success:function(response){if(response.count>0){$this.html(response.count);}}});}});});function receivePinterestShareCount(data){var $elem=$('.pinterest-share-count[data-url="'+data.url+'"]');if($elem.length>0&&data.count>0){$elem.html(data.count);}}
$(function(){$('.new-post-form-container').each(function(){var $statusFormContainer=$(this);var statusForm=new StatusForm({$formContainer:$statusFormContainer,sendURI:'news/createComment',module:'news',success:function(response){if(response.status==='unapproved'){var $successMessageContainer=$('.form-success-container',$statusFormContainer);$successMessageContainer.html(response.message).show();setTimeout(function(){$successMessageContainer.hide();},6000);}
reloadComments();}});});initComments();function initComments($container=null){$container=$container||$('#news-comments-container');$('.main-comment-container',$container).each(function(){initComment($(this));});}
function initComment($commentContainer){var comment=new CommentCtrl({$mainCommentContainer:$commentContainer,editURI:'history/update_com_text',replyToURI:null,module:'news',commentDeleted:function(){$commentContainer.remove();},stickyStatusUpdated:function(){reloadComments();},replyToPosted:null});return comment;}
$(document).on('click','#load-more-comments',function(){var $this=$(this);$this.html(lang('general:loading')+'...').css({'cursor':'wait','pointer-events':'none'});loadMoreComments($this.data('page'));return false;});function reloadComments(){$.ajax({url:BASE_URI+'news/getNewsCommentsHTML/'+NEWS_POST_ID,success:function(response){if(response.status==='success'){$('#news-comments-container').html(response.html);setTimeout(function(){initComments();});setLoadMoreCommentsLink(response.loadMore);}}});}
function loadMoreComments(page){$.ajax({url:BASE_URI+'news/getNewsCommentsHTML/'+NEWS_POST_ID+'/'+page,success:function(response){if(response.status==='success'){var $newBatch=$(response.html);$('#news-comments-container').append($newBatch);setTimeout(function(){$newBatch.filter('.main-comment-container').each(function(){initComment($(this));});});setLoadMoreCommentsLink(response.loadMore);}}});}
function setLoadMoreCommentsLink($loadMore){var $loadMoreLink=$('#load-more-comments');if($loadMore){$loadMoreLink.data('page',$loadMore).html(lang('general:load_more')+'...').show().css({'cursor':'pointer','pointer-events':'auto'});}else{$loadMoreLink.hide();}}});
var frontEndCommonSettings;function frontEndCommon_InitSettings(settings){frontEndCommonSettings={variables:{setTimeout:600,slideUpSpeed:500,slideDownSpeed:500,fadeOutSpeed:500,fadeInSpeed:500,showSpeed:500,hideSpeed:500,scrollSpeed:500,scrollAnimationEasing:'swing',v3MenuHeightEstimate:($('#menu-bar')[0]?$('#menu-bar').outerHeight():0)+($('#functional-bar')[0]?$('#functional-bar').outerHeight():0),VALIDATION_DATA_SEPARATOR:($('input[name="VALIDATION_DATA_SEPARATOR"]').length>0)?$('input[name="VALIDATION_DATA_SEPARATOR"]').val():"--validation--"}};frontEndCommonSettings=$.extend(true,frontEndCommonSettings,settings);}
function frontEndCommon_ClickOnControl_ShowHideForm(buttonSelector,formSelector,callback){if(buttonSelector!=undefined&&formSelector!=undefined){$(document).on('click',buttonSelector,function(event){event.preventDefault();var $form=$(formSelector);var $this=$(this);($form.is(":visible"))?frontEndCommon_HideForm($form,$this,callback):frontEndCommon_ShowForm($form,$this,callback);});}else{console.log('Missing paramaters: frontEndCommon_ClickOnControl_ShowHideForm : '+buttonSelector+', '+formSelector+', '+callback);}}
function frontEndCommon_ShowForm($form,$element,callback){$form.data('is_form_opening',true);$form.css('display','none').removeClass('hidden');$form.slideDown(frontEndCommonSettings.variables.slideDownSpeed,function(){$('html, body').animate({scrollTop:($form.offset().top-frontEndCommonSettings.variables.v3MenuHeightEstimate)+'px'},frontEndCommonSettings.variables.scrollSpeed,frontEndCommonSettings.variables.scrollAnimationEasing,function(){callback!=undefined?callback($element):null;})});}
function frontEndCommon_HideForm($form,$element,callback){$form.data('is_form_opening',false);$form.slideUp(frontEndCommonSettings.variables.slideUpSpeed,function(){callback!=undefined?callback($element):null;$form.addClass("hidden");});}
function frontEndCommon_ShowMessage(bsAlertType,message,isHidingAutomatically,$domElement,isCreatingMessageContainer,isShowing,isRemovable,msgContainerCssClass,isInsertAfter){var randomClassName=Math.random().toString(36).substr(2,5);if(msgContainerCssClass==undefined){msgContainerCssClass="";}
if(isCreatingMessageContainer==undefined||isCreatingMessageContainer){$messageContainer=$('<div class="front-end-v3-msg-container col-md-12 alert alert-'+bsAlertType+' p-2 '+msgContainerCssClass+'">'+
((isRemovable==undefined||isRemovable)?'<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>':'')+
message+'</div>');}else if(message!=''){$messageContainer=$(message);$messageContainer.addClass('front-end-v3-msg-container');}
if(isShowing==undefined||isShowing){if(isInsertAfter==undefined||isInsertAfter==false){$messageContainer.insertBefore($domElement);}else{$messageContainer.insertAfter($domElement);}
$messageContainer.addClass(randomClassName);if(isHidingAutomatically){setTimeout(function(){$('.front-end-v3-msg-container.'+randomClassName).remove();frontEndCommon_EnableButtons();},frontEndCommonSettings.variables.setTimeout);}}else{$('.front-end-v3-msg-container').remove();}}
function frontEndCommon_HideMessage(){frontEndCommon_ShowMessage('','',false,null,false,false);}
function frontEndCommon_ScrollToElement($element,callback){$('html, body').animate({scrollTop:($element.offset().top-frontEndCommonSettings.variables.v3MenuHeightEstimate)+'px'},frontEndCommonSettings.variables.scrollSpeed,frontEndCommonSettings.variables.scrollAnimationEasing,(callback==undefined)?function(){}:callback());}
function frontEndCommon_DisableButtons(btnSelectors,isDisabling){if(btnSelectors==undefined||btnSelectors==null){btnSelectors='.btn:not(.abc-letter), div.pagination li, div.pagination a';}
if(isDisabling==undefined||isDisabling==true){$(btnSelectors).each(function(){$btn=$(this);if(!$btn.prop('disabled')){if($btn.data('original_classes')==undefined){$btn.data('original_classes',$btn.attr('class'));}
$btn.prop('disabled',true).addClass('disabled');}});}else{$(btnSelectors).each(function(){$btn=$(this);if($btn.prop('disabled')){$btn.removeClass();$btn.prop('disabled',false).removeClass('disabled');if($btn.data('original_classes')!=undefined){$btn.attr('class',$btn.data('original_classes'));}}});}}
function frontEndCommon_EnableButtons(btnSelectors){if(btnSelectors==undefined||btnSelectors==null){btnSelectors='.btn, div.pagination li, div.pagination a';}
frontEndCommon_DisableButtons(btnSelectors,false);}
function frontEndCommon_ShowElements(selectors,type,isShowing){if($.isArray(selectors)){$.each(selectors,function(index,selector){frontEndCommon_ShowElements(selector,type,isShowing);});}else{if(isShowing==undefined||isShowing==true){switch(type){case'class':$(selectors).removeClass('hidden');break;case'style':$(selectors).css('display','block');break;default:$(selectors).removeClass('hidden');break;}}
else{switch(type){case'class':$(selectors).addClass('hidden');break;case'style':$(selectors).css('display','none');break;default:$(selectors).addClass('hidden');break;}}}}
function frontEndCommon_HideElements(selectors,type){frontEndCommon_ShowElements(selectors,type,false);}
function frontEndCommon_CollectFormData(formContainerSelector){var formData={};$(formContainerSelector+' input:not(:checkbox)').each(function(){formData[$(this).attr('name')]=$(this).val();});$(formContainerSelector+' :checkbox').each(function(){formData[$(this).attr('name')]=$(this).is(':checked')?1:0;});$(formContainerSelector+' textarea').each(function(){formData[$(this).attr('name')]=$(this).val();});$(formContainerSelector+' .selectpicker').each(function(){formData[$(this).attr('name')]=$(this).val();});$(formContainerSelector+' .multilevel-multiselect-group').each(function(){var $this=$(this);var fieldName=$this.attr('name').replace('_list','');formData[fieldName]=$this.find('input[name="'+fieldName+'"]').val();});return formData;}
function frontEndCommon_ClearFormFields(formContainerSelector){$(formContainerSelector+' input').each(function(){$(this).val('');});$(formContainerSelector+' .selectpicker').each(function(){$(this).val('').selectpicker('refresh');});$(formContainerSelector+' .multilevel-multiselect-group').each(function(){$(this).find('.selected_ids').val('');$(this).find('li').removeClass('selected').removeClass('seperatly-selected');$(this).find('button.multilevel').find('span.selected_values').html('');if($.trim($(this).find('.default_button_text').val())!=""){$(this).find('button.multilevel').find('span.selected_values').html($(this).find('.default_button_text').val());}
else if($(this).find('.form-placeholder').length>0){$(this).find('.form-placeholder').show();}});$(formContainerSelector).find('.ql-editor').html('');$(formContainerSelector).find('.dynamic-popup-list-container').remove();$(formContainerSelector).find('.abc-letter.active').each(function(){$(this).trigger('change');});}
function frontEndCommon_ToggleClass_OnHover(controlCssClass,toggleClass){$(controlCssClass).hover(function(){$(this).addClass(toggleClass);},function(){$(this).removeClass(toggleClass);});}
if(!window.hasOwnProperty('shareAStoryNewDesign')){window.shareAStoryNewDesign=true;$(function(){FORM.hidingUndesirablePlaceholders('.form-placeholder');FORM.setControlOnPlaceholders_AutoHide('.form-placeholder','.form-control');$(window).on('load',function(){var pageSection=sessionStorage.getItem('loggedOutStory_PageSection');if($.trim(pageSection)!=""){var $section=$('#'+pageSection);var $container=$section.find('.share-a-story-form-container');if($container.length>0){var scrollTop=$section.offset().top-100;$('html, body').animate({scrollTop:scrollTop<0?0:scrollTop});}
sessionStorage.removeItem('loggedOutStory_PageSection');}});$('input[name=people_tag]').tagitTTVersion({autocompleteURL:BASE_URI+'tags/ac_online_users',placeholderText:lang('general:start_typing_to_tag_members')+'...'});$(document).on('submit','.submit_article',function(e){e.preventDefault();var $form=$(this);var url=$form.attr('action');var data=$form.serialize();var $submitBtn=$('.submit-upload-a-story-form-btn');var page=$('.page').val()!=undefined?$('.page').val():null;var $section=$form.closest('.customisation-section');var $container=$section.find('.share-a-story-form-container');var $successContainer=$section.find('.story-submit-success-container');var $thankYoucontainer=$section.find('.thank-you-for-sharing-story-msg');$submitBtn.prop('disabled',true).html(lang('general:submitting')+'...');$thankYoucontainer.hide();if(!FORM_CHECK.isInputFieldsContainerValid('#'+$form.attr('id'))){$submitBtn.html(lang('general:upload')).prop('disabled',false);return;}else{if($submitBtn.data('type')==='loggedOut'){sessionStorage.setItem("loggedOutStory_PageSection",$section.prop('id'));$container.hide();$section.find('.simple-login-container').slideDown('slow',function(){$(window).scrollTop($section.offset().top);});AJAX.call("news/loggedOutStory_SaveToSession",data+'&pageUri='+$(location).prop('href'));return;}
$.ajax({url:url,type:'POST',data:data,cache:false,success:function(response){if(response.status==='success'){$('.cancel-upload-a-story-btn',$form).click();$container.data('share-article-form-status','closed');if(page){window.location.reload(true);}else{$thankYoucontainer.show();}
if(response.messages){ourHelpingFunctions.displayNotices($successContainer,response.messages);}}else{ourHelpingFunctions.displayNotices($('.story-submit-error-container',$form),response.messages);$('.story-submit-error-container',$form).show();}},error:function(){ourHelpingFunctions.displayNotices($('.story-submit-error-container',$form),[{type:'danger',text:lang('general:error_submitting_form')+'. '+lang('general:please_try_again')}]);$('.story-submit-error-container',$form).show();},complete:function(){$submitBtn.prop('disabled',false).html(lang('general:submit'));}});}
return false;});$('.cancel-upload-a-story-btn').click(function(){var $section=$(this).closest('.customisation-section');var $container=$section.find('.share-a-story-form-container');var $successContainer=$section.find('.story-submit-success-container');var $form=$(this).closest('form');var $thankYoucontainer=$section.find('.thank-you-for-sharing-story-msg');$form[0].reset();$thankYoucontainer.hide();$('[data-croppie-image-placeholder=story-image]').attr('src','').hide();$('.ql-editor',$form).html('');$('input[name=people_tag]',$form).tagit('removeAll');$('.story-submit-error-container',$form).html('').hide();$container.slideUp('slow',function(){$('.share-a-story-btn').removeClass('hidden').removeClass('d-none');});if($successContainer.length>0){$('html, body').animate({scrollTop:$successContainer.offset().top-200});}
return false;});$('.share-a-story-btn').click(function(){var $btn=$(this);var $section=$btn.closest('.customisation-section');var $container=$section.find('.share-a-story-form-container');var $successContainer=$section.find('.story-submit-success-container');var $thankYoucontainer=$section.find('.thank-you-for-sharing-story-msg');$container.slideToggle('slow',function(){$container.css('overflow','visible');$btn.addClass('d-none');});$successContainer.html('');$thankYoucontainer.hide();});});function shareAStrory_LoginFormCallback_Cancelled(section){var $section=$('#'+section+'-section');$section.find('.simple-login-container').hide();if($section.find('.share-a-story-btn').length>0){$section.find('.share-a-story-btn').trigger('click');}else{var $container=$section.find('.share-a-story-form-container');$container.hide('slow',function(){$container.css('overflow','visible');});$section.find('.story-submit-success-container').html('');$section.find('.thank-you-for-sharing-story-msg').hide();}
$section.find('.submit-upload-a-story-form-btn').html(lang('general:upload')).prop('disabled',false);}
function shareAStrory_LoginFormCallback_LoggedIn(section){location.href=BASE_URI+'thank-you-for-your-logged-out-post';}}
$(document).ready(function(){if(typeof initPhotoSwipeFromDOM!=='undefined'){initPhotoSwipeFromDOM('.my-gallery');}});
